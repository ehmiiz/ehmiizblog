<!DOCTYPE html>
<html lang="en-us">

<head>
  
  <meta charset="utf-8">



<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    <meta name="description" content="My journey into C# so far I&rsquo;ve always been somewhat interested in programming, and PowerShell scripting and module making has put fire to that interest. The natural next language to learn for me has always been C#, reason being it&rsquo;s easy to pick up if you already know PowerShell and it enables you to create binary PowerShell modules.
Some content I&rsquo;ve devoured to increase my C# knowledge are:
C# Fundamentals course on PluralSight by Scott Allen PowerShell to C# And Back, Book by Deepak Dhami &amp; Prateek Singh Various YouTube content and talks on building PowerShell Binary Modules using C#:">
  


<meta name="color-scheme" content="light dark">







<meta name="generator" content="Hugo 0.121.2">
  <title>PowerShell: C Sharp for PowerShell Modules | all posts</title>
  <link rel="canonical" href="https://www.ehmiiz.se/blog/ps_making_binary_ps_module/">




  








  
    
  
  
      <link rel="stylesheet" href="/css/base.min.1acad582ac8b152661f9475cff97ae7980a4773d7013b34229d2f382e85b6cd6.min.1acad582ac8b152661f9475cff97ae7980a4773d7013b34229d2f382e85b6cd6.css" integrity="sha256-GsrVgqyLFSZh&#43;Udc/5eueYCkdz1wE7NCKdLzguhbbNY=" crossorigin="anonymous">

      <link rel="stylesheet" href="/css/syntax.min.065df42d2be658bb8e0720297aadf469355a5ffaf863b00e3cce0627dd106ca0.css" integrity="sha256-Bl30LSvmWLuOByApeq30aTVaX/r4Y7AOPM4GJ90QbKA=" crossorigin="anonymous">



</head>

<body>
  <nav class="u-background">
  <div class="u-wrapper">
    <ul class="Banner">
      <li class="Banner-item Banner-item--title">
        <h1 class="Banner-heading">
          <a class="Banner-link u-clickable" href="/">all posts</a>
        </h1>
      </li>
      
        
        
        <li class="Banner-item">
          <a class="Banner-link u-clickable" href="/home/">home</a>
        </li>
      
        
        
        <li class="Banner-item">
          <a class="Banner-link u-clickable" href="/blog/">blog</a>
        </li>
      
        
        
        <li class="Banner-item">
          <a class="Banner-link u-clickable" href="/about/">about</a>
        </li>
      
        
        
        <li class="Banner-item">
          <a class="Banner-link u-clickable" href="/software/">software</a>
        </li>
      
    </ul>
  </div>
</nav>

  <main>
    <div class="u-wrapper">
      <div class="u-padding">
        

  <article>
    <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/blog/ps_making_binary_ps_module/" rel="bookmark">PowerShell: C Sharp for PowerShell Modules</a>
  </h2>
  
    <time datetime="2022-08-15T14:58:11&#43;01:00">August 15, 2022</time>
  
</header>
    <figure><img src="/pics/stack_books.jpg"/>
</figure>

<h2 id="my-journey-into-c-so-far">
  <a class="Heading-link u-clickable" href="/blog/ps_making_binary_ps_module/#my-journey-into-c-so-far">My journey into C# so far</a>
</h2>
<p>I&rsquo;ve always been somewhat interested in programming, and PowerShell scripting and module making has put fire to that interest.
The natural next language to learn for me has always been C#, reason being it&rsquo;s easy to pick up if you already know PowerShell and it enables you to create binary PowerShell modules.</p>
<p>Some content I&rsquo;ve devoured to increase my C# knowledge are:</p>
<ul>
<li>C# Fundamentals course on PluralSight by Scott Allen</li>
<li>PowerShell to C# And Back, Book by Deepak Dhami &amp; Prateek Singh</li>
</ul>
<p>Various YouTube content and talks on building PowerShell Binary Modules using C#:</p>
<ul>
<li>Building Cross Platform PowerShell Modules by Adam Driscoll</li>
<li>Writing Compiled PowerShell Cmdlets by Thomas Rayner</li>
</ul>
<p>The above lists are things I&rsquo;ve went through and I can honestly recommend.</p>
<h2 id="whats-to-come">
  <a class="Heading-link u-clickable" href="/blog/ps_making_binary_ps_module/#whats-to-come">What&rsquo;s to come</a>
</h2>
<p>I plan to further increase my knowledge with the books:</p>
<ul>
<li>The C# Player&rsquo;s Guide, Book by RB Whitaker</li>
<li>C# In Depth, Book by Jon Skeet</li>
</ul>
<p>As well as writing more modules and other C# related projects.</p>
<h2 id="the-process-of-wrapping-a-binary-module-using-a-nuget-package">
  <a class="Heading-link u-clickable" href="/blog/ps_making_binary_ps_module/#the-process-of-wrapping-a-binary-module-using-a-nuget-package">The process of wrapping a binary module using a nuget package</a>
</h2>
<ol>
<li>
<p>Install a modern version of the dotnet cli together with a dotnet sdk suitable for that version</p>
</li>
<li>
<p>Init an empty git repo for the new code to live in</p>
</li>
<li>
<p>Navigate to the folder; dotnet new classlib. This will generate a dotnet class library, once compiled it will generate a DLL file that will be our module</p>
</li>
<li>
<p>In the csproj file, to make the module compatible with Win PowerShell &amp; PowerShell, we set the TargetFramework to &ldquo;netstandard2.0&rdquo;</p>
</li>
<li>
<p>Remove ImplicitUsings and Nullable Enabled. These are language features we do not need</p>
</li>
<li>
<p>dotnet add package PowerShell Standard.Library</p>
</li>
<li>
<p>dotnet add package thenugetpackage</p>
</li>
<li>
<p>dotnet publish. We have now added the packages needed to start wrapping the nuget package into a PowerShell module</p>
</li>
<li>
<p>To follow the official PowerShell repos naming standard, all the cmdlets are to be named: VerbNounCommand.cs</p>
</li>
</ol>
<p>The following source code is commented to help one with a PowerShell background to understand it easier:</p>

  

<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Csharp" data-lang="Csharp"><span class="line"><span class="cl"><span class="c1">// Usings, similar to Import-Module</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">System.Management.Automation</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="nn">PasswordGenerator</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="nn">PasswordGenerator</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// VerbsCommon contains a list of approved common verbs, the string Password is the Noun of the cmdlet</span>
</span></span><span class="line"><span class="cl"><span class="na">    [Cmdlet(VerbsCommon.New,&#34;Password&#34;)]</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Cmdletname : PSCmdlet, similar to Function Name {}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="k">class</span> <span class="nc">GetGeneratedPasswordCommand</span> <span class="p">:</span> <span class="n">PSCmdlet</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// [Parameter], default value is 16. If Get &gt; Default, if set &gt; set the value of the param</span>
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">int</span> <span class="n">_pwLengthDefault</span> <span class="p">=</span> <span class="m">16</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="na">        [Parameter]</span>
</span></span><span class="line"><span class="cl"><span class="na">        [ValidateRange(4,128)]</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Int32</span> <span class="n">Length</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">get</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">_pwLengthDefault</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">set</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">_pwLengthDefault</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">private</span> <span class="kt">int</span> <span class="n">_amountDefault</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="na">        [Parameter]</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">Int32</span> <span class="n">Amount</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">get</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">_amountDefault</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">set</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">_amountDefault</span> <span class="p">=</span> <span class="k">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// Switch parameters, they turn true if specified</span>
</span></span><span class="line"><span class="cl"><span class="na">        [Parameter]</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">SwitchParameter</span> <span class="n">IncludeSpecial</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">        [Parameter]</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">SwitchParameter</span> <span class="n">IncludeNumeric</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">        [Parameter]</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">SwitchParameter</span> <span class="n">IncludeUppercase</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">        [Parameter]</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">SwitchParameter</span> <span class="n">IncludeLowercase</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">protected</span> <span class="kd">override</span> <span class="k">void</span> <span class="n">ProcessRecord</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// for loop, same concept as in PowerShell</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">Amount</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="n">IncludeNumeric</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeSpecial</span><span class="p">().</span><span class="n">IncludeNumeric</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeLowercase</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeNumeric</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeLowercase</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeSpecial</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeLowercase</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeLowercase</span><span class="p">().</span><span class="n">IncludeUppercase</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="n">IncludeUppercase</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeUppercase</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeLowercase</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeLowercase</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeSpecial</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeLowercase</span><span class="p">().</span><span class="n">IncludeUppercase</span><span class="p">().</span><span class="n">IncludeSpecial</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeNumeric</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeLowercase</span><span class="p">().</span><span class="n">IncludeUppercase</span><span class="p">().</span><span class="n">IncludeNumeric</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="n">IncludeLowercase</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeLowercase</span><span class="p">().</span><span class="n">IncludeSpecial</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="n">IncludeNumeric</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeLowercase</span><span class="p">().</span><span class="n">IncludeNumeric</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeSpecial</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeUppercase</span><span class="p">().</span><span class="n">IncludeSpecial</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="p">!</span><span class="n">IncludeSpecial</span> <span class="p">&amp;</span> <span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeNumeric</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeUppercase</span><span class="p">().</span><span class="n">IncludeNumeric</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="n">IncludeSpecial</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeLowercase</span><span class="p">().</span><span class="n">IncludeSpecial</span><span class="p">().</span><span class="n">IncludeNumeric</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span> <span class="k">if</span> <span class="p">(!</span><span class="n">IncludeLowercase</span> <span class="p">&amp;</span> <span class="n">IncludeUppercase</span> <span class="p">&amp;</span> <span class="n">IncludeNumeric</span> <span class="p">&amp;</span> <span class="n">IncludeSpecial</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeUppercase</span><span class="p">().</span><span class="n">IncludeSpecial</span><span class="p">().</span><span class="n">IncludeNumeric</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span>
</span></span><span class="line"><span class="cl">                <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">pwd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Password</span><span class="p">(</span><span class="n">Length</span><span class="p">).</span><span class="n">IncludeLowercase</span><span class="p">().</span><span class="n">IncludeUppercase</span><span class="p">().</span><span class="n">IncludeSpecial</span><span class="p">().</span><span class="n">IncludeNumeric</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">var</span> <span class="n">password</span> <span class="p">=</span> <span class="n">pwd</span><span class="p">.</span><span class="n">Next</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">WriteObject</span><span class="p">(</span><span class="n">password</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></div>
<p>The rest is a matter of figuring out how the package works, and what it supports.
Make sure to try to get all the functionality of the package out in the PowerShell module. Obviously it might require you to make more cmdlets.</p>
<p>Next blog will be how I published my module to the PowerShell Gallery. Using Git, Github, PSGallery and PlatyPS.</p>
<p>Stay tuned!</p>
<h3 id="happy-coding">
  <a class="Heading-link u-clickable" href="/blog/ps_making_binary_ps_module/#happy-coding">Happy coding</a>
</h3>
<h3 id="emil">
  <a class="Heading-link u-clickable" href="/blog/ps_making_binary_ps_module/#emil">/Emil</a>
</h3>

    

  

  





    
  

  </article>


      </div>
    </div>
  </main>
  <style>
body {
    font-size: 110%;
}
</style>

<style>
html {
    overflow-y: scroll;
}
</style>
<style>
.social-icon svg {
    width: 45px;   
    height: 45px;  
}

.social-icons-container {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
}
</style>
<div class="social-icons-container">

<a href="https://twitter.com/ehmiiz" target="_blank" rel="noopener">
    <span class="social-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 512 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span>
</a>


<a href="https://linkedin.com/in/emilarsson" target="_blank" rel="noopener">
    <span class="social-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg></span>
</a>


<a href="https://github.com/ehmiiz" target="_blank" rel="noopener">
    <span class="social-icon"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 496 512"><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3 .3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5 .3-6.2 2.3zm44.2-1.7c-2.9 .7-4.9 2.6-4.6 4.9 .3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3 .7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3 .3 2.9 2.3 3.9 1.6 1 3.6 .7 4.3-.7 .7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3 .7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3 .7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span>
</a>
</div>

</body>

</html>
